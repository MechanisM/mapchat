/* jquery.couch.js */
(function(e){function y(c){var d=e.ajax(c);if(!c.chunked||!c.progress)return d;var g=d.onreadystatechange,i=c.progress,a=0;d.onreadystatechange=function(){if(d.readyState===3){i(d.responseText.substr(a));a=d.responseText.length;if(d.responseText.length>(c.bufferLimit||64E3)){try{d.abort()}catch(b){}c.success({})}}return g.apply(this,arguments)};return d}function s(c){var d=c.split("/");if(d[0]=="_design"){d.shift();return"_design/"+encodeURIComponent(d.join("/"))}return encodeURIComponent(c)}function z(c,
d){if(typeof hex_sha1=="undefined")alert("creating a user doc requires sha1.js to be loaded in the page");else{c._id=c._id||"org.couchdb.user:"+c.name;if(d){c.salt=e.couch.newUUID();c.password_sha=hex_sha1(d+c.salt)}c.type="user";if(!c.roles)c.roles=[];return c}}function k(c,d,g,i){d=e.extend({successStatus:200},d);i=e.extend({contentType:"application/json"},i);g=g||"Unknown error";return y(e.extend(e.extend({type:"GET",dataType:"json",cache:!e.browser.msie,beforeSend:function(a){if(i&&i.headers)for(var b in i.headers)a.setRequestHeader(b,
i.headers[b])},complete:function(a){try{var b=e.httpData(a,"json")}catch(f){d.error?d.error(a.status,a,f):alert(g+": "+f);return}d.ajaxStart&&d.ajaxStart(b);if(a.status==d.successStatus){d.beforeSuccess&&d.beforeSuccess(a,b);d.success&&d.success(b)}else d.error?d.error(a.status,b&&b.error||g,b&&b.reason||"no response"):alert(g+": "+b.reason)}},c),i))}function x(c){c=c||{};if(typeof c.ensure_full_commit!=="undefined"){var d=c.ensure_full_commit;delete c.ensure_full_commit;return function(g){g.setRequestHeader("X-Couch-Full-Commit",
d.toString())}}}function n(c){var d=[];if(typeof c==="object"&&c!==null)for(var g in c)if(!(e.inArray(g,["error","success","beforeSuccess","ajaxStart"])>=0)){var i=c[g];if(e.inArray(g,["key","startkey","endkey"])>=0)i=q(i);d.push(encodeURIComponent(g)+"="+encodeURIComponent(i))}return d.length?"?"+d.join("&"):""}function q(c){return c!==null?JSON.stringify(c):null}e.couch=e.couch||{};var u=[];e.extend(e.couch,{urlPrefix:"",activeTasks:function(c){k({url:this.urlPrefix+"/_active_tasks"},c,"Active task status could not be retrieved")},
allDbs:function(c){k({url:this.urlPrefix+"/_all_dbs"},c,"An error occurred retrieving the list of all databases")},config:function(c,d,g,i){var a={url:this.urlPrefix+"/_config/"};if(d){a.url+=encodeURIComponent(d)+"/";if(g)a.url+=encodeURIComponent(g)}if(i===null)a.type="DELETE";else if(i!==undefined){a.type="PUT";a.data=q(i);a.contentType="application/json";a.processData=false}k(a,c,"An error occurred retrieving/updating the server configuration")},session:function(c){c=c||{};e.ajax({type:"GET",
url:this.urlPrefix+"/_session",complete:function(d){var g=e.httpData(d,"json");if(d.status==200)c.success&&c.success(g);else c.error?c.error(d.status,g.error,g.reason):alert("An error occurred getting session info: "+g.reason)}})},userDb:function(c){e.couch.session({success:function(d){d=e.couch.db(d.info.authentication_db);c(d)}})},signup:function(c,d,g){g=g||{};c=z(c,d);e.couch.userDb(function(i){i.saveDoc(c,g)})},login:function(c){c=c||{};e.ajax({type:"POST",url:this.urlPrefix+"/_session",dataType:"json",
data:{name:c.name,password:c.password},complete:function(d){var g=e.httpData(d,"json");if(d.status==200)c.success&&c.success(g);else c.error?c.error(d.status,g.error,g.reason):alert("An error occurred logging in: "+g.reason)}})},logout:function(c){c=c||{};e.ajax({type:"DELETE",url:this.urlPrefix+"/_session",dataType:"json",username:"_",password:"_",complete:function(d){var g=e.httpData(d,"json");if(d.status==200)c.success&&c.success(g);else c.error?c.error(d.status,g.error,g.reason):alert("An error occurred logging out: "+
g.reason)}})},db:function(c,d){function g(a){if(a._id&&a._rev&&i[a._id]&&i[a._id].rev==a._rev)if(typeof Base64=="undefined"){alert("please include /_utils/script/base64.js in the page for base64 support");return false}else{a._attachments=a._attachments||{};a._attachments["rev-"+a._rev.split("-")[0]]={content_type:"application/json",data:Base64.encode(i[a._id].raw)};return true}}d=d||{};var i={};return{name:c,uri:this.urlPrefix+"/"+encodeURIComponent(c)+"/",compact:function(a){e.extend(a,{successStatus:202});
k({type:"POST",url:this.uri+"_compact",data:"",processData:false},a,"The database could not be compacted")},viewCleanup:function(a){e.extend(a,{successStatus:202});k({type:"POST",url:this.uri+"_view_cleanup",data:"",processData:false},a,"The views could not be cleaned up")},compactView:function(a,b){e.extend(b,{successStatus:202});k({type:"POST",url:this.uri+"_compact/"+a,data:"",processData:false},b,"The view could not be compacted")},create:function(a){e.extend(a,{successStatus:201});k({type:"PUT",
url:this.uri,contentType:"application/json",data:"",processData:false},a,"The database could not be created")},drop:function(a){k({type:"DELETE",url:this.uri},a,"The database could not be deleted")},info:function(a){k({url:this.uri},a,"Database information could not be retrieved")},changes:function(a,b){function f(l){e.each(t,function(){this(l)})}function h(l){v+=l;l=v.split(/\n/g);if(l.length>1){v=l.pop();l.forEach(j)}}function j(l){try{l=e.parseJSON(l)}catch(A){e.log("Can't parse server's response: "+
A.toString());return}if(l){a=l.seq;f({results:[l],last_seq:a})}}function m(){var l=e.extend({heartbeat:1E4},b,{feed:b.continuous?"continuous":"longpoll",since:a});w=k({url:r.uri+"_changes"+n(l)},b,"Error connecting to "+r.uri+"/_changes.",b.continuous&&{chunked:true,progress:h})}b=b||{};var p=100,r=this,o=true,t=[],v="",w=null;b.continuous=e.browser.webkit;b.success=b.continuous?function(){p=100;o&&m()}:function(l){p=100;if(o){a=l.last_seq;f(l);m()}};b.error=function(){if(o){setTimeout(m,p);p*=2}};
a?m():r.info({success:function(l){a=l.update_seq;m()}});return{onChange:function(l){t.push(l)},stop:function(){o=false;if(w)try{w.abort()}catch(l){}}}},allDocs:function(a){var b="GET",f=null;if(a.keys){b="POST";f=a.keys;delete a.keys;f=q({keys:f})}k({type:b,data:f,url:this.uri+"_all_docs"+n(a)},a,"An error occurred retrieving a list of all documents")},allDesignDocs:function(a){this.allDocs(e.extend({startkey:"_design",endkey:"_design0"},a))},allApps:function(a){a=a||{};var b=this;a.eachApp?this.allDesignDocs({success:function(f){e.each(f.rows,
function(){b.openDoc(this.id,{success:function(h){var j,m,p=h._id.split("/");p.shift();p=p.join("/");if(j=h.couchapp&&h.couchapp.index)m=["",c,h._id,j].join("/");else if(h._attachments&&h._attachments["index.html"])m=["",c,h._id,"index.html"].join("/");m&&a.eachApp(p,m,h)}})})}}):alert("Please provide an eachApp function for allApps()")},openDoc:function(a,b,f){b=b||{};d.attachPrevRev||b.attachPrevRev?e.extend(b,{beforeSuccess:function(h,j){i[j._id]={rev:j._rev,raw:h.responseText}}}):e.extend(b,{beforeSuccess:function(h,
j){if(j["jquery.couch.attachPrevRev"])i[j._id]={rev:j._rev,raw:h.responseText}}});k({url:this.uri+s(a)+n(b)},b,"The document could not be retrieved",f)},saveDoc:function(a,b){b=b||{};var f=this,h=x(b),j=b.update&&b.update.split("/",2),m=j?"_design/"+j[0]+"/_update/"+j[1]+"/":"";delete b.update;if(a._id===undefined){j="POST";m=this.uri+m}else{j="PUT";m=this.uri+m+s(a._id)}var p=g(a);e.ajax({type:j,url:m+n(b),contentType:"application/json",dataType:"json",data:q(a),beforeSend:h,complete:function(r){var o=
e.httpData(r,"json");if(r.status==200||r.status==201||r.status==202){a._id=o.id;a._rev=o.rev;if(p)f.openDoc(a._id,{attachPrevRev:true,success:function(t){a._attachments=t._attachments;b.success&&b.success(o)}});else b.success&&b.success(o)}else b.error?b.error(r.status,o.error,o.reason):alert("The document could not be saved: "+o.reason)}})},bulkSave:function(a,b){var f=x(b);e.extend(b,{successStatus:201,beforeSend:f});k({type:"POST",url:this.uri+"_bulk_docs"+n(b),contentType:"application/json",data:q(a)},
b,"The documents could not be saved")},removeDoc:function(a,b){k({type:"DELETE",url:this.uri+s(a._id)+n({rev:a._rev})},b,"The document could not be deleted")},bulkRemove:function(a,b){a.docs=e.each(a.docs,function(f,h){h._deleted=true});e.extend(b,{successStatus:201});k({type:"POST",url:this.uri+"_bulk_docs"+n(b),data:q(a)},b,"The documents could not be deleted")},copyDoc:function(a,b,f){f=e.extend(f,{complete:function(h){var j=e.httpData(h,"json");if(h.status==201)b.success&&b.success(j);else b.error?
b.error(h.status,j.error,j.reason):alert("The document could not be copied: "+j.reason)}});k({type:"COPY",url:this.uri+s(a)},b,"The document could not be copied",f)},query:function(a,b,f,h){f=f||"javascript";if(typeof a!=="string")a=a.toSource?a.toSource():"("+a.toString()+")";a={language:f,map:a};if(b!=null){if(typeof b!=="string")b=b.toSource?b.toSource():"("+b.toString()+")";a.reduce=b}k({type:"POST",url:this.uri+"_temp_view"+n(h),contentType:"application/json",data:q(a)},h,"An error occurred querying the database")},
list:function(a,b,f){a=a.split("/");f=f||{};var h="GET",j=null;if(f.keys){h="POST";j=f.keys;delete f.keys;j=q({keys:j})}k({type:h,data:j,url:this.uri+"_design/"+a[0]+"/_list/"+a[1]+"/"+b+n(f)},f,"An error occured accessing the list")},view:function(a,b){a=a.split("/");b=b||{};var f="GET",h=null;if(b.keys){f="POST";h=b.keys;delete b.keys;h=q({keys:h})}k({type:f,data:h,url:this.uri+"_design/"+a[0]+"/_view/"+a[1]+n(b)},b,"An error occurred accessing the view")},getDbProperty:function(a,b,f){k({url:this.uri+
a+n(b)},b,"The property could not be retrieved",f)},setDbProperty:function(a,b,f,h){k({type:"PUT",url:this.uri+a+n(f),data:JSON.stringify(b)},f,"The property could not be updated",h)}}},encodeDocId:s,info:function(c){k({url:this.urlPrefix+"/"},c,"Server information could not be retrieved")},replicate:function(c,d,g,i){i=e.extend({source:c,target:d},i);if(i.continuous)g.successStatus=202;k({type:"POST",url:this.urlPrefix+"/_replicate",data:JSON.stringify(i),contentType:"application/json"},g,"Replication failed")},
newUUID:function(c){if(c===undefined)c=1;u.length||k({url:this.urlPrefix+"/_uuids",data:{count:c},async:false},{success:function(d){u=d.uuids}},"Failed to retrieve UUID batch.");return u.shift()}})})(jQuery);

/* jquery.couch.app.js */
(function(b){function n(h,e,c){this.doc_id="_design/"+e;this.code_path=c?this.doc_id+"/"+c:this.doc_id;this.view=function(a,g){h.view(e+"/"+a,g)};this.list=function(a,g,i){h.list(e+"/"+a,g,i)}}function m(){alert("docForm has been moved to vendor/couchapp/lib/docForm.js, use app.require to load")}function f(h,e,c,a){c=c||[];if(e.length===0){if(typeof a!="string")throw["error","invalid_require_path","Must require a JavaScript string, not: "+typeof a];return[a,c]}var g=e.shift();if(g==".."){c.pop();
a=c.pop();if(!a)throw["error","invalid_require_path",h];return f(h,e,c,a)}else if(g=="."){a=c.pop();if(!a)throw["error","invalid_require_path",h];return f(h,e,c,a)}else c=[];if(!a[g])throw["error","invalid_require_path",h];c.push(a);return f(h,e,c,a[g])}function p(h){function e(g,i){var j,d,l=c.length;for(d=0;d<l;++d){j=c[d].key;if(j[0]===g&&j[1]===i)return c[d].module}return null}var c=[],a=function(g,i){var j=e(g,i);if(j!==null)return j;j={};var d=f(g,g.split("/"),i,h),l=d[0];i=d[1];d="var func = function (exports, require) { "+
l+" };";try{eval(d);func.apply(h,[j,function(o){return a(o,i)}])}catch(k){throw["error","compilation_error","Module require('"+g+"') raised error "+k.toSource()];}c.push({key:[g,i],module:j});return j};return a}function q(){var h=document.location.pathname.split("/"),e={};document.location.search.replace(/^\?/,"").split("&").forEach(function(c){var a=c.split("=");c=decodeURIComponent(a[0]);a=decodeURIComponent(a[1]);e[c]=["startkey","endkey","key"].indexOf(c)!=-1?JSON.parse(a):a});h.shift();return{path:h,
query:e}}b.couch.app=b.couch.app||function(h,e){function c(k){if(k){l.ddoc=k;l.require=p(k)}h.apply(l,[l])}e=e||{};var a=e.urlPrefix||"",g=a.split("/").length,i=unescape(document.location.href).split("/"),j=e.db||i[g+2];g=e.design||i[g+4];b.couch.urlPrefix=a;a=b.couch.db(j);var d=new n(a,g,e.load_path),l=b.extend({db:a,design:d,view:d.view,list:d.list,docForm:m,req:q()},b.couch.app.app);if(e.ddoc)b.couch.app.ddocs[d.doc_id]=e.ddoc;if(b.couch.app.ddocs[d.doc_id])b(function(){c(b.couch.app.ddocs[d.doc_id])});
else if(b.couch.app.ddoc_handlers[d.doc_id])b.couch.app.ddoc_handlers[d.doc_id].push(c);else{b.couch.app.ddoc_handlers[d.doc_id]=[c];a.getDbProperty(d.code_path,{success:function(k){b.couch.app.ddocs[d.doc_id]=k;b.couch.app.ddoc_handlers[d.doc_id].forEach(function(o){b(function(){o(k)})});b.couch.app.ddoc_handlers[d.doc_id]=null},error:function(){b.couch.app.ddoc_handlers[d.doc_id].forEach(function(k){b(function(){k()})});b.couch.app.ddoc_handlers[d.doc_id]=null}})}};b.couch.app.ddocs={};b.couch.app.ddoc_handlers=
{};b.CouchApp=b.couch.app})(jQuery);if(!Array.prototype.forEach)Array.prototype.forEach=function(b,n){var m=this.length>>>0;if(typeof b!="function")throw new TypeError;for(var f=0;f<m;f++)f in this&&b.call(n,this[f],f,this)};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(b,n){var m=this.length>>>0,f=Number(n)||0;f=f<0?Math.ceil(f):Math.floor(f);if(f<0)f+=m;for(;f<m;f++)if(f in this&&this[f]===b)return f;return-1};

/* jquery.couch.app.util.js */
$.log=function(a){if(window&&window.console&&window.console.log)window.console.log(arguments.length==1?a:arguments)};$.fn.serializeObject=function(){var a={},b=this.serializeArray();$.each(b,function(){if(a[this.name]){a[this.name].push||(a[this.name]=[a[this.name]]);a[this.name].push(this.value||"")}else a[this.name]=this.value||""});return a};function escapeHTML(a){return a&&a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}
function safeHTML(a,b){return a?escapeHTML(a.substring(0,b)):""}$.linkify=function(a){return a.replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi,function(b){return'<a target="_blank" href="'+b+'">'+b+"</a>"}).replace(/\@([\w\-]+)/g,function(b,c){return'<a href="#/mentions/'+encodeURIComponent(c.toLowerCase())+'">'+b+"</a>"}).replace(/\#([\w\-\.]+)/g,function(b,c){return'<a href="#/tags/'+encodeURIComponent(c.toLowerCase())+'">'+b+"</a>"})};
$.fn.prettyDate=function(){$(this).each(function(){var a;a=(a=$(this).attr("title"))?$.prettyDate(a):$.prettyDate($(this).text());$(this).text(a)})};
$.prettyDate=function(a){var b=new Date(a.replace(/-/g,"/").replace("T"," ").replace("Z"," +0000").replace(/(\d*\:\d*:\d*)\.\d*/g,"$1"));b=((new Date).getTime()-b.getTime())/1E3;var c=Math.floor(b/86400);if(isNaN(c))return a;return c<1&&(b<60&&"just now"||b<120&&"1 minute ago"||b<3600&&Math.floor(b/60)+" minutes ago"||b<7200&&"1 hour ago"||b<86400&&Math.floor(b/3600)+" hours ago")||c==1&&"yesterday"||c<21&&c+" days ago"||c<45&&Math.ceil(c/7)+" weeks ago"||a};
$.argsToArray=function(a){if(!a.callee)return a;for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};

/* jquery.evently.js */
function $$(b){if(!b){if($$(window).localStorage)return $$(window).localStorage;return $$(window).localStorage={get:function(h){try{var i=JSON.parse(this._storage[h])}catch(m){}return i!==null&&typeof i==="object"?i:{}},set:function(h,i){try{return this._storage[h]=JSON.stringify(i)}catch(m){$.log(m)}},_storage:window.localStorage||{}}}var g=$(b).data("$$");if(!g){g={};$(b).data("$$",g)}return g}
(function(b){function g(a,c){if(a&&a.match&&a.match(/^function/)){eval("var f = "+a);if(typeof f=="function")return function(){try{var d=f.apply(this,arguments)}catch(e){b.log({message:"Error in evently function.",error:e,src:a,hint:c});throw e;}if(c==="_init")return false;return d}}return a}function h(a,c){var d=[true,{}],e=c.evently||{};b.forIn(c.vendor||{},function(j,k){k.evently&&k.evently[a]&&d.push(k.evently[a])});e[a]&&d.push(e[a]);return b.extend.apply(null,d)}function i(a){if(a._common){b.forIn(a,
function(c,d){a[c]=b.extend(true,{},a._common,d)});delete a._common}return a}function m(a,c,d,e){if(b.isArray(d))for(var j=0;j<d.length;j++)m(a,c,d[j],e);else{var k=g(d,c);if(typeof k=="function")a.bind(c,{args:e},k);else typeof k=="string"?a.bind(c,{args:e},function(){b(this).trigger(k);return false}):a.bind(c,{args:e},function(){l(b(this),d,arguments);return false});d.path&&a.pathbinder(c,d.path)}}function l(a,c,d,e){e=e||{};var j,k=b.evently.fn.before;for(j in k)if(k.hasOwnProperty(j))if(c[j]&&
!e[j]){e[j]=true;k[j].apply(a,[c,function(){l(a,c,b.argsToArray(arguments).concat(b.argsToArray(d)),e)},d]);return}var q;b.forIn(b.evently.fn.render,function(n,o){if(c[n])q=o.apply(a,[c,d])});b.forIn(b.evently.fn.after,function(n,o){c[n]&&o.apply(a,[c,q,d])})}function p(a,c,d){if(d)$$(a).app=d;if(typeof c=="string")c=h(c,d.ddoc);c=i(c);$$(a).evently=c;if(d&&d.ddoc)$$(a).partials=h("_partials",d.ddoc);return c}b.log=function(a){if(window&&window.console&&window.console.log)window.console.log(arguments.length==
1?a:arguments)};b.forIn=function(a,c){for(var d in a)a.hasOwnProperty(d)&&c(d,a[d])};b.argsToArray=function(a){if(!a.callee)return a;for(var c=[],d=0;d<a.length;d++)c.push(a[d]);return c};b.fn.replace=function(a){b(this).empty().append(a)};b.fn.evently=function(a,c,d){var e=b(this);a=p(e,a,c);b.forIn(a,function(j,k){m(e,j,k,d)});b.forIn(b.evently.fn.setup,function(j,k){a[j]&&k.apply(e,[a[j],d])});return this};b.evently={connect:function(a,c,d){d.forEach(function(e){b(a).bind(e,function(){var j=b.makeArray(arguments),
k=j.shift();j.push(k);b(c).trigger(e,j);return false})})},paths:[],changesDBs:{},changesOpts:{},utils:{rfun:function(a,c,d){var e=g(c,a);return typeof e=="function"?e.apply(a,d):c},evfun:g},fn:{setup:{},before:{},render:{},after:{}}}})(jQuery);(function(b){b.evently.fn.setup._init=function(g,h){this.trigger("_init",h)}})(jQuery);(function(b){b.evently.fn.before.before=function(g,h,i){b.evently.utils.evfun(g.before,this).apply(this,i);h()}})(jQuery);
(function(b){b.evently.fn.before.async=function(g,h,i){b.evently.utils.evfun(g.async,this).apply(this,[h].concat(b.argsToArray(i)))}})(jQuery);(function(b){var g=b.evently.utils.rfun;b.evently.fn.render.mustache=function(h,i){var m=(h.render||"replace").replace(/\s/g,""),l;l=$$(this).partials;l=b(b.mustache(g(this,h.mustache,i),g(this,h.data,i),g(this,b.extend(true,l,h.partials),i)));this[m](l);return l}})(jQuery);
(function(b){b.evently.fn.after.selectors=function(g,h,i){var m=(g.render||"replace").replace(/\s/g,""),l=$$(this).app,p=m=="replace"?this:h;g=b.evently.utils.rfun(this,g.selectors,i);b.forIn(g,function(a,c){b(a,p).evently(c,l,i)})}})(jQuery);(function(b){b.evently.fn.after.after=function(g,h,i){b.evently.utils.rfun(this,g.after,i)}})(jQuery);

/* jquery.evently.couch.js */
(function(g){function j(d){var c=d.db.name,a=function(f){g("body").trigger("evently-changes-"+c,[f])};if(!g.evently.changesDBs[c]){d.db.changes?d.db.changes(null,g.evently.changesOpts).onChange(a):b(d,a);g.evently.changesDBs[c]=true}}function b(d,c,a){function f(h){h=d.db.uri+"_changes?heartbeat=10000&feed=longpoll&since="+h;if(g.evently.changesOpts.include_docs)h+="&include_docs=true";g.ajax({url:h,contentType:"application/json",dataType:"json",complete:function(i){i=g.httpData(i,"json");c(i);b(d,
c,i.last_seq)}})}a?f(a):d.db.info({success:function(h){f(h.update_seq)}})}g.evently.fn.setup._changes=function(){var d=this,c=$$(this).app;if(c){g("body").bind("evently-changes-"+c.db.name,function(){d.trigger("_changes")});j(c);d.trigger("_changes")}};g.evently.followChanges=j})(jQuery);
(function(g){function j(b,d,c,a){var f,h=a.success,i=false;a.success=function(e){$$(b).inFlight=false;var k=JSON.stringify($$(b).highKey);e.rows=e.rows.filter(function(l){return JSON.stringify(l.key)!=k});if(e.rows.length>0)if(a.descending)$$(b).highKey=e.rows[0].key;else $$(b).highKey=e.rows[e.rows.length-1].key;h&&h(e,i)};f=a.descending?c+(a.startkey?JSON.stringify(a.startkey):""):c+(a.endkey?JSON.stringify(a.endkey):"");if(f==$$(b).lastViewId){f=$$(b).highKey;if(f!==undefined)if(a.descending)a.endkey=
f;else a.startkey=f;if(!$$(b).inFlight){$$(b).inFlight=true;d.view(c,a)}}else{i=true;$$(b).lastViewId=f;$$(b).highKey=undefined;$$(b).inFlight=true;d.view(c,a)}}g.evently.fn.before.query=function(b,d,c){var a=$$(this).app;b=g.evently.utils.rfun(this,b.query,c);c=b.type;var f=b.view,h=b.success,i={};g.forIn(b,function(e,k){if(["type","view"].indexOf(e)==-1)i[e]=k});if(c=="newRows"){i.success=function(e){e.rows.reverse().forEach(d);h&&h(e)};j(this,a,f,i)}else{i.success=function(e){d(e);h&&h(e)};a.view(f,
i)}}})(jQuery);

/* jquery.mustache.js */
(function(l){var m=function(){var g=function(){};g.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(a,b,c,d){if(!d){this.context=b;this.buffer=[]}if(!this.includes("",a))if(d)return a;else{this.send(a);return}a=this.render_pragmas(a);a=this.render_section(a,b,c);if(d)return this.render_tags(a,b,c,d);this.render_tags(a,b,c,d)},send:function(a){a!=""&&this.buffer.push(a)},render_pragmas:function(a){if(!this.includes("%",a))return a;
var b=this;return a.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(c,d,e){if(!b.pragmas_implemented[d])throw{message:"This implementation of mustache doesn't understand the '"+d+"' pragma"};b.pragmas[d]={};if(e){c=e.split("=");b.pragmas[d][c[0]]=c[1]}return""})},render_partial:function(a,b,c){a=this.trim(a);if(!c||c[a]===undefined)throw{message:"unknown_partial '"+a+"'"};if(typeof b[a]!="object")return this.render(c[a],b,c,true);return this.render(c[a],b[a],c,true)},render_section:function(a,
b,c){if(!this.includes("#",a)&&!this.includes("^",a))return a;var d=this;return a.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(e,i,j,h){e=d.find(j,b);if(i=="^")return!e||d.is_array(e)&&e.length===0?d.render(h,b,c,true):"";else if(i=="#")return d.is_array(e)?d.map(e,function(f){return d.render(h,d.create_context(f),c,true)}).join(""):d.is_object(e)?d.render(h,d.create_context(e),c,true):typeof e==="function"?
e.call(b,h,function(f){return d.render(f,b,c,true)}):e?d.render(h,b,c,true):""})},render_tags:function(a,b,c,d){var e=this,i=function(){return RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")},j=i(),h=function(o,n,k){switch(n){case "!":return"";case "=":e.set_delimiters(k);j=i();return"";case ">":return e.render_partial(k,b,c);case "{":return e.find(k,b);default:return e.escape(e.find(k,b))}};a=a.split("\n");for(var f=0;f<a.length;f++){a[f]=a[f].replace(j,h,this);d||this.send(a[f])}if(d)return a.join("\n")},
set_delimiters:function(a){a=a.split(" ");this.otag=this.escape_regex(a[0]);this.ctag=this.escape_regex(a[1])},escape_regex:function(a){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){a=this.trim(a);var c;if(b[a]===false||b[a]===0||b[a])c=b[a];else if(this.context[a]===false||this.context[a]===0||this.context[a])c=this.context[a];if(typeof c==="function")return c.apply(b);
if(c!==undefined)return c;return""},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(a){a=String(a===null?"":a);return a.replace(/&(?!\w+;)|["<>\\]/g,function(b){switch(b){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return b}})},create_context:function(a){if(this.is_object(a))return a;else{var b=".";if(this.pragmas["IMPLICIT-ITERATOR"])b=this.pragmas["IMPLICIT-ITERATOR"].iterator;var c={};c[b]=a;return c}},
is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function")return a.map(b);else{for(var c=[],d=a.length,e=0;e<d;e++)c.push(b(a[e]));return c}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(a,b,c,d){var e=new g;if(d)e.send=d;e.render(a,b,c);if(!d)return e.buffer.join("\n")},escape:function(a){return(new g).escape(a)}}}();
l.mustache=function(g,a,b){return m.to_html(g,a,b)};l.mustache.escape=function(g){return m.escape(g)}})(jQuery);

/* jquery.pathbinder.js */
(function(c){function r(){h=k();if(l!=h){l=h;return m(h)}}function s(a){function b(){h=k();l!=h&&setTimeout(function(){c(window).trigger("hashchange")},1)}b();p=setInterval(b,a);c(window).bind("unload",function(){clearInterval(p)})}function m(a){a=a.replace(/^#/,"");c.pathbinder.changeFuns.forEach(function(t){t(a)});for(var b,d,e={},f,i,g=0;g<c.pathbinder.paths.length;g++){b=c.pathbinder.paths[g];if((d=b.matcher.exec(a))!==null){d.shift();for(var j=0;j<d.length;j++){f=b.param_names[j];i=decodeURIComponent(d[j]);
if(f)e[f]=i;else{if(!e.splat)e.splat=[];e.splat.push(i)}}b.callback(e)}}}function o(a){if(a)window.location="#"+a;l=k()}function k(){var a=window.location.toString().match(/^[^#]*(#.+)$/);return a?a[1]:""}function u(a,b){var d=[];for(n.lastIndex=0;(path_match=n.exec(a))!==null;)d.push(path_match[1]);return{param_names:d,matcher:RegExp("^"+a.replace(n,v).replace(q,w)+"/?$"),template:a.replace(n,function(e,f){return"{{"+f+"}}"}).replace(q,"{{splat}}"),callback:b}}var v="([^/]+)",n=/:([\w\d]+)/g,q=/(\*)/,
w="(.+)",h,l,p;c.pathbinder={changeFuns:[],paths:[],begin:function(a){c(function(){var b=k();if(b)m(b);else{o(a);m(a)}})},go:function(a){o(a);m(a)},currentPath:function(){return k()},onChange:function(a){c.pathbinder.changeFuns.push(a)}};c(function(){"onhashchange"in window||s(10);c(window).bind("hashchange",r)});c.fn.pathbinder=function(a,b,d){d=d||{};var e=c(this);b=b.split(/\n/);c.each(b,function(){if(this){var f=u(this,function(i){e.trigger(a,[i])});d.bindPath&&e.bind(a,function(i,g){g=g||{};
var j=c.mustache(f.template,g);o(j)});c.pathbinder.paths.push(f)}})}})(jQuery);
