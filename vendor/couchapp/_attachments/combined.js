(function(b){function h(c){var a=b.ajax(c);if(!c.chunked||!c.progress)return a;var e=a.onreadystatechange,g=c.progress,k=0;a.onreadystatechange=function(){if(a.readyState===3&&(g(a.responseText.substr(k)),k=a.responseText.length,a.responseText.length>(c.bufferLimit||64E3))){try{a.abort()}catch(b){}c.success({})}return e.apply(this,arguments)};return a}function d(b){var a=b.split("/");if(a[0]=="_design")return a.shift(),"_design/"+encodeURIComponent(a.join("/"));return encodeURIComponent(b)}function a(c,
a){if(typeof hex_sha1=="undefined")alert("creating a user doc requires sha1.js to be loaded in the page");else{c._id=c._id||"org.couchdb.user:"+c.name;if(a)c.salt=b.couch.newUUID(),c.password_sha=hex_sha1(a+c.salt);c.type="user";if(!c.roles)c.roles=[];return c}}function g(c,a,e,g){a=b.extend({successStatus:200},a);g=b.extend({contentType:"application/json"},g);e=e||"Unknown error";return h(b.extend(b.extend({type:"GET",dataType:"json",cache:!b.browser.msie,beforeSend:function(b){if(g&&g.headers)for(var a in g.headers)b.setRequestHeader(a,
g.headers[a])},complete:function(c){try{var o=b.httpData(c,"json")}catch(g){a.error?a.error(c.status,c,g):alert(e+": "+g);return}a.ajaxStart&&a.ajaxStart(o);c.status==a.successStatus?(a.beforeSuccess&&a.beforeSuccess(c,o),a.success&&a.success(o)):a.error?a.error(c.status,o&&o.error||e,o&&o.reason||"no response"):alert(e+": "+o.reason)}},c),g))}function l(b){b=b||{};if(typeof b.ensure_full_commit!=="undefined"){var a=b.ensure_full_commit;delete b.ensure_full_commit;return function(b){b.setRequestHeader("X-Couch-Full-Commit",
a.toString())}}}function i(a){var g=[];if(typeof a==="object"&&a!==null)for(var j in a)if(!(b.inArray(j,["error","success","beforeSuccess","ajaxStart"])>=0)){var i=a[j];b.inArray(j,["key","startkey","endkey"])>=0&&(i=e(i));g.push(encodeURIComponent(j)+"="+encodeURIComponent(i))}return g.length?"?"+g.join("&"):""}function e(b){return b!==null?JSON.stringify(b):null}b.couch=b.couch||{};var j=[];b.extend(b.couch,{urlPrefix:"",activeTasks:function(b){g({url:this.urlPrefix+"/_active_tasks"},b,"Active task status could not be retrieved")},
allDbs:function(b){g({url:this.urlPrefix+"/_all_dbs"},b,"An error occurred retrieving the list of all databases")},config:function(b,a,j,i){var k={url:this.urlPrefix+"/_config/"};a&&(k.url+=encodeURIComponent(a)+"/",j&&(k.url+=encodeURIComponent(j)));if(i===null)k.type="DELETE";else if(i!==void 0)k.type="PUT",k.data=e(i),k.contentType="application/json",k.processData=!1;g(k,b,"An error occurred retrieving/updating the server configuration")},session:function(a){a=a||{};b.ajax({type:"GET",url:this.urlPrefix+
"/_session",complete:function(e){var g=b.httpData(e,"json");e.status==200?a.success&&a.success(g):a.error?a.error(e.status,g.error,g.reason):alert("An error occurred getting session info: "+g.reason)}})},userDb:function(a){b.couch.session({success:function(e){e=b.couch.db(e.info.authentication_db);a(e)}})},signup:function(c,e,g){g=g||{};c=a(c,e);b.couch.userDb(function(b){b.saveDoc(c,g)})},login:function(a){a=a||{};b.ajax({type:"POST",url:this.urlPrefix+"/_session",dataType:"json",data:{name:a.name,
password:a.password},complete:function(e){var g=b.httpData(e,"json");e.status==200?a.success&&a.success(g):a.error?a.error(e.status,g.error,g.reason):alert("An error occurred logging in: "+g.reason)}})},logout:function(a){a=a||{};b.ajax({type:"DELETE",url:this.urlPrefix+"/_session",dataType:"json",username:"_",password:"_",complete:function(e){var g=b.httpData(e,"json");e.status==200?a.success&&a.success(g):a.error?a.error(e.status,g.error,g.reason):alert("An error occurred logging out: "+g.reason)}})},
db:function(a,j){function h(a){if(a._id&&a._rev&&m[a._id]&&m[a._id].rev==a._rev)return typeof Base64=="undefined"?(alert("please include /_utils/script/base64.js in the page for base64 support"),!1):(a._attachments=a._attachments||{},a._attachments["rev-"+a._rev.split("-")[0]]={content_type:"application/json",data:Base64.encode(m[a._id].raw)},!0)}j=j||{};var m={};return{name:a,uri:this.urlPrefix+"/"+encodeURIComponent(a)+"/",compact:function(a){b.extend(a,{successStatus:202});g({type:"POST",url:this.uri+
"_compact",data:"",processData:!1},a,"The database could not be compacted")},viewCleanup:function(a){b.extend(a,{successStatus:202});g({type:"POST",url:this.uri+"_view_cleanup",data:"",processData:!1},a,"The views could not be cleaned up")},compactView:function(a,e){b.extend(e,{successStatus:202});g({type:"POST",url:this.uri+"_compact/"+a,data:"",processData:!1},e,"The view could not be compacted")},create:function(a){b.extend(a,{successStatus:201});g({type:"PUT",url:this.uri,contentType:"application/json",
data:"",processData:!1},a,"The database could not be created")},drop:function(a){g({type:"DELETE",url:this.uri},a,"The database could not be deleted")},info:function(a){g({url:this.uri},a,"Database information could not be retrieved")},changes:function(a,e){function c(a){b.each(m,function(){this(a)})}function j(a){q+=a;a=q.split(/\n/g);a.length>1&&(q=a.pop(),a.forEach(l))}function l(e){try{e=b.parseJSON(e)}catch(g){b.log("Can't parse server's response: "+g.toString());return}if(e)a=e.seq,c({results:[e],
last_seq:a})}function d(){var c=b.extend({heartbeat:1E4},e,{feed:e.continuous?"continuous":"longpoll",since:a});r=g({url:p.uri+"_changes"+i(c)},e,"Error connecting to "+p.uri+"/_changes.",e.continuous&&{chunked:!0,progress:j})}e=e||{};var h=100,p=this,n=!0,m=[],q="",r=null;e.continuous=b.browser.webkit;e.success=e.continuous?function(){h=100;n&&d()}:function(b){h=100;if(n)a=b.last_seq,c(b),d()};e.error=function(){n&&(setTimeout(d,h),h*=2)};a?d():p.info({success:function(b){a=b.update_seq;d()}});return{onChange:function(a){m.push(a)},
stop:function(){n=!1;if(r)try{r.abort()}catch(a){}}}},allDocs:function(a){var b="GET",c=null;if(a.keys)b="POST",c=a.keys,delete a.keys,c=e({keys:c});g({type:b,data:c,url:this.uri+"_all_docs"+i(a)},a,"An error occurred retrieving a list of all documents")},allDesignDocs:function(a){this.allDocs(b.extend({startkey:"_design",endkey:"_design0"},a))},allApps:function(e){e=e||{};var g=this;e.eachApp?this.allDesignDocs({success:function(j){b.each(j.rows,function(){g.openDoc(this.id,{success:function(b){var g,
j,o=b._id.split("/");o.shift();o=o.join("/");(g=b.couchapp&&b.couchapp.index)?j=["",a,b._id,g].join("/"):b._attachments&&b._attachments["index.html"]&&(j=["",a,b._id,"index.html"].join("/"));j&&e.eachApp(o,j,b)}})})}}):alert("Please provide an eachApp function for allApps()")},openDoc:function(a,e,c){e=e||{};j.attachPrevRev||e.attachPrevRev?b.extend(e,{beforeSuccess:function(a,b){m[b._id]={rev:b._rev,raw:a.responseText}}}):b.extend(e,{beforeSuccess:function(a,b){b["jquery.couch.attachPrevRev"]&&(m[b._id]=
{rev:b._rev,raw:a.responseText})}});g({url:this.uri+d(a)+i(e)},e,"The document could not be retrieved",c)},saveDoc:function(a,c){c=c||{};var g=this,j=l(c),p=c.update&&c.update.split("/",2),m=p?"_design/"+p[0]+"/_update/"+p[1]+"/":"";delete c.update;a._id===void 0?(p="POST",m=this.uri+m):(p="PUT",m=this.uri+m+d(a._id));var t=h(a);b.ajax({type:p,url:m+i(c),contentType:"application/json",dataType:"json",data:e(a),beforeSend:j,complete:function(e){var j=b.httpData(e,"json");e.status==200||e.status==201||
e.status==202?(a._id=j.id,a._rev=j.rev,t?g.openDoc(a._id,{attachPrevRev:!0,success:function(b){a._attachments=b._attachments;c.success&&c.success(j)}}):c.success&&c.success(j)):c.error?c.error(e.status,j.error,j.reason):alert("The document could not be saved: "+j.reason)}})},bulkSave:function(a,c){var j=l(c);b.extend(c,{successStatus:201,beforeSend:j});g({type:"POST",url:this.uri+"_bulk_docs"+i(c),contentType:"application/json",data:e(a)},c,"The documents could not be saved")},removeDoc:function(a,
b){g({type:"DELETE",url:this.uri+d(a._id)+i({rev:a._rev})},b,"The document could not be deleted")},bulkRemove:function(a,c){a.docs=b.each(a.docs,function(a,b){b._deleted=!0});b.extend(c,{successStatus:201});g({type:"POST",url:this.uri+"_bulk_docs"+i(c),data:e(a)},c,"The documents could not be deleted")},copyDoc:function(a,e,c){c=b.extend(c,{complete:function(a){var c=b.httpData(a,"json");a.status==201?e.success&&e.success(c):e.error?e.error(a.status,c.error,c.reason):alert("The document could not be copied: "+
c.reason)}});g({type:"COPY",url:this.uri+d(a)},e,"The document could not be copied",c)},query:function(a,b,c,j){c=c||"javascript";typeof a!=="string"&&(a=a.toSource?a.toSource():"("+a.toString()+")");a={language:c,map:a};if(b!=null)typeof b!=="string"&&(b=b.toSource?b.toSource():"("+b.toString()+")"),a.reduce=b;g({type:"POST",url:this.uri+"_temp_view"+i(j),contentType:"application/json",data:e(a)},j,"An error occurred querying the database")},list:function(a,b,c){a=a.split("/");c=c||{};var j="GET",
d=null;if(c.keys)j="POST",d=c.keys,delete c.keys,d=e({keys:d});g({type:j,data:d,url:this.uri+"_design/"+a[0]+"/_list/"+a[1]+"/"+b+i(c)},c,"An error occured accessing the list")},view:function(a,b){a=a.split("/");b=b||{};var c="GET",j=null;if(b.keys)c="POST",j=b.keys,delete b.keys,j=e({keys:j});g({type:c,data:j,url:this.uri+"_design/"+a[0]+"/_view/"+a[1]+i(b)},b,"An error occurred accessing the view")},getDbProperty:function(a,b,e){g({url:this.uri+a+i(b)},b,"The property could not be retrieved",e)},
setDbProperty:function(a,b,e,c){g({type:"PUT",url:this.uri+a+i(e),data:JSON.stringify(b)},e,"The property could not be updated",c)}}},encodeDocId:d,info:function(a){g({url:this.urlPrefix+"/"},a,"Server information could not be retrieved")},replicate:function(a,e,j,i){i=b.extend({source:a,target:e},i);if(i.continuous)j.successStatus=202;g({type:"POST",url:this.urlPrefix+"/_replicate",data:JSON.stringify(i),contentType:"application/json"},j,"Replication failed")},newUUID:function(a){a===void 0&&(a=
1);j.length||g({url:this.urlPrefix+"/_uuids",data:{count:a},async:!1},{success:function(a){j=a.uuids}},"Failed to retrieve UUID batch.");return j.shift()}})})(jQuery);(function(b){function h(a,b,g){this.doc_id="_design/"+b;this.code_path=g?this.doc_id+"/"+g:this.doc_id;this.view=function(c,g){a.view(b+"/"+c,g)};this.list=function(c,g,j){a.list(b+"/"+c,g,j)}}function d(){alert("docForm has been moved to vendor/couchapp/lib/docForm.js, use app.require to load")}function a(b,e,g,c){g=g||[];if(e.length===0){if(typeof c!="string")throw["error","invalid_require_path","Must require a JavaScript string, not: "+typeof c];return[c,g]}var d=e.shift();if(d==".."){g.pop();
c=g.pop();if(!c)throw["error","invalid_require_path",b];return a(b,e,g,c)}else if(d=="."){c=g.pop();if(!c)throw["error","invalid_require_path",b];return a(b,e,g,c)}else g=[];if(!c[d])throw["error","invalid_require_path",b];g.push(c);return a(b,e,g,c[d])}function g(b){function e(a,b){var e,c,d=g.length;for(c=0;c<d;++c)if(e=g[c].key,e[0]===a&&e[1]===b)return g[c].module;return null}var g=[],c=function(d,l){var h=e(d,l);if(h!==null)return h;h={};var k=a(d,d.split("/"),l,b),o=k[0];l=k[1];try{eval("var func = function (exports, require) { "+
o+" };"),func.apply(b,[h,function(a){return c(a,l)}])}catch(s){throw["error","compilation_error","Module require('"+d+"') raised error "+s.toSource()];}g.push({key:[d,l],module:h});return h};return c}function l(){var a=document.location.pathname.split("/"),b={};document.location.search.replace(/^\?/,"").split("&").forEach(function(a){var c=a.split("=");a=decodeURIComponent(c[0]);c=decodeURIComponent(c[1]);b[a]=["startkey","endkey","key"].indexOf(a)!=-1?JSON.parse(c):c});a.shift();return{path:a,query:b}}
b.couch.app=b.couch.app||function(a,e){function j(b){if(b)o.ddoc=b,o.require=g(b);a.apply(o,[o])}e=e||{};var c=e.urlPrefix||"",p=c.split("/").length,n=unescape(document.location.href).split("/"),m=e.db||n[p+2];p=e.design||n[p+4];b.couch.urlPrefix=c;c=b.couch.db(m);var k=new h(c,p,e.load_path),o=b.extend({db:c,design:k,view:k.view,list:k.list,docForm:d,req:l()},b.couch.app.app);if(e.ddoc)b.couch.app.ddocs[k.doc_id]=e.ddoc;b.couch.app.ddocs[k.doc_id]?b(function(){j(b.couch.app.ddocs[k.doc_id])}):b.couch.app.ddoc_handlers[k.doc_id]?
b.couch.app.ddoc_handlers[k.doc_id].push(j):(b.couch.app.ddoc_handlers[k.doc_id]=[j],c.getDbProperty(k.code_path,{success:function(a){b.couch.app.ddocs[k.doc_id]=a;b.couch.app.ddoc_handlers[k.doc_id].forEach(function(e){b(function(){e(a)})});b.couch.app.ddoc_handlers[k.doc_id]=null},error:function(){b.couch.app.ddoc_handlers[k.doc_id].forEach(function(a){b(function(){a()})});b.couch.app.ddoc_handlers[k.doc_id]=null}}))};b.couch.app.ddocs={};b.couch.app.ddoc_handlers={};b.CouchApp=b.couch.app})(jQuery);
if(!Array.prototype.forEach)Array.prototype.forEach=function(b,h){var d=this.length>>>0;if(typeof b!="function")throw new TypeError;for(var a=0;a<d;a++)a in this&&b.call(h,this[a],a,this)};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(b,h){var d=this.length>>>0,a=Number(h)||0;a=a<0?Math.ceil(a):Math.floor(a);for(a<0&&(a+=d);a<d;a++)if(a in this&&this[a]===b)return a;return-1};$.log=function(b){window&&window.console&&window.console.log&&window.console.log(arguments.length==1?b:arguments)};$.fn.serializeObject=function(){var b={},h=this.serializeArray();$.each(h,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""});return b};function escapeHTML(b){return b&&b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}
function safeHTML(b,h){return b?escapeHTML(b.substring(0,h)):""}$.linkify=function(b){return b.replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi,function(b){return'<a target="_blank" href="'+b+'">'+b+"</a>"}).replace(/\@([\w\-]+)/g,function(b,d){return'<a href="#/mentions/'+encodeURIComponent(d.toLowerCase())+'">'+b+"</a>"}).replace(/\#([\w\-\.]+)/g,function(b,d){return'<a href="#/tags/'+encodeURIComponent(d.toLowerCase())+'">'+b+"</a>"})};
$.fn.prettyDate=function(){$(this).each(function(){var b;b=(b=$(this).attr("title"))?$.prettyDate(b):$.prettyDate($(this).text());$(this).text(b)})};
$.prettyDate=function(b){var h=new Date(b.replace(/-/g,"/").replace("T"," ").replace("Z"," +0000").replace(/(\d*\:\d*:\d*)\.\d*/g,"$1"));h=((new Date).getTime()-h.getTime())/1E3;var d=Math.floor(h/86400);if(isNaN(d))return b;return d<1&&(h<60&&"just now"||h<120&&"1 minute ago"||h<3600&&Math.floor(h/60)+" minutes ago"||h<7200&&"1 hour ago"||h<86400&&Math.floor(h/3600)+" hours ago")||d==1&&"yesterday"||d<21&&d+" days ago"||d<45&&Math.ceil(d/7)+" weeks ago"||b};
$.argsToArray=function(b){if(!b.callee)return b;for(var h=[],d=0;d<b.length;d++)h.push(b[d]);return h};(function(b){var h=function(){var b=function(){};b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,d,i){if(!i)this.context=b,this.buffer=[];if(!this.includes("",a))if(i)return a;else{this.send(a);return}a=this.render_pragmas(a);a=this.render_section(a,b,d);if(i)return this.render_tags(a,b,d,i);this.render_tags(a,b,d,i)},send:function(a){a!=""&&this.buffer.push(a)},render_pragmas:function(a){if(!this.includes("%",a))return a;
var b=this;return a.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(a,d,e){if(!b.pragmas_implemented[d])throw{message:"This implementation of mustache doesn't understand the '"+d+"' pragma"};b.pragmas[d]={};e&&(a=e.split("="),b.pragmas[d][a[0]]=a[1]);return""})},render_partial:function(a,b,d){a=this.trim(a);if(!d||d[a]===void 0)throw{message:"unknown_partial '"+a+"'"};if(typeof b[a]!="object")return this.render(d[a],b,d,!0);return this.render(d[a],b[a],d,!0)},render_section:function(a,
b,d){if(!this.includes("#",a)&&!this.includes("^",a))return a;var i=this;return a.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(a,j,c,h){a=i.find(c,b);if(j=="^")return!a||i.is_array(a)&&a.length===0?i.render(h,b,d,!0):"";else if(j=="#")return i.is_array(a)?i.map(a,function(a){return i.render(h,i.create_context(a),d,!0)}).join(""):i.is_object(a)?i.render(h,i.create_context(a),d,!0):typeof a==="function"?a.call(b,
h,function(a){return i.render(a,b,d,!0)}):a?i.render(h,b,d,!0):""})},render_tags:function(a,b,d,h){var e=this,j=function(){return RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")},c=j(),p=function(a,h,i){switch(h){case "!":return"";case "=":return e.set_delimiters(i),c=j(),"";case ">":return e.render_partial(i,b,d);case "{":return e.find(i,b);default:return e.escape(e.find(i,b))}};a=a.split("\n");for(var n=0;n<a.length;n++)a[n]=a[n].replace(c,p,this),h||this.send(a[n]);if(h)return a.join("\n")},
set_delimiters:function(a){a=a.split(" ");this.otag=this.escape_regex(a[0]);this.ctag=this.escape_regex(a[1])},escape_regex:function(a){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){a=this.trim(a);var d;b[a]===!1||b[a]===0||b[a]?d=b[a]:(this.context[a]===!1||this.context[a]===0||this.context[a])&&(d=this.context[a]);if(typeof d==="function")return d.apply(b);if(d!==
void 0)return d;return""},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(a){return String(a===null?"":a).replace(/&(?!\w+;)|["<>\\]/g,function(a){switch(a){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return a}})},create_context:function(a){if(this.is_object(a))return a;else{var b=".";if(this.pragmas["IMPLICIT-ITERATOR"])b=this.pragmas["IMPLICIT-ITERATOR"].iterator;var d={};d[b]=a;return d}},is_object:function(a){return a&&
typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function")return a.map(b);else{for(var d=[],h=a.length,e=0;e<h;e++)d.push(b(a[e]));return d}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(a,g,h,i){var e=new b;if(i)e.send=i;e.render(a,g,h);if(!i)return e.buffer.join("\n")},escape:function(a){return(new b).escape(a)}}}();b.mustache=function(b,
a,g){return h.to_html(b,a,g)};b.mustache.escape=function(b){return h.escape(b)}})(jQuery);(function(b){function h(){n=l();if(m!=n)return m=n,a(n)}function d(a){function e(){n=l();m!=n&&setTimeout(function(){b(window).trigger("hashchange")},1)}e();k=setInterval(e,a);b(window).bind("unload",function(){clearInterval(k)})}function a(a){a=a.replace(/^#/,"");b.pathbinder.changeFuns.forEach(function(b){b(a)});for(var e,c,d={},g,j,h=0;h<b.pathbinder.paths.length;h++)if(e=b.pathbinder.paths[h],(c=e.matcher.exec(a))!==null){c.shift();for(var i=0;i<c.length;i++)if(g=e.param_names[i],j=decodeURIComponent(c[i]),
g)d[g]=j;else{if(!d.splat)d.splat=[];d.splat.push(j)}e.callback(d)}}function g(a){if(a)window.location="#"+a;m=l()}function l(){var a=window.location.toString().match(/^[^#]*(#.+)$/);return a?a[1]:""}function i(a,b){var d=[];for(j.lastIndex=0;(path_match=j.exec(a))!==null;)d.push(path_match[1]);return{param_names:d,matcher:RegExp("^"+a.replace(j,e).replace(c,p)+"/?$"),template:a.replace(j,function(a,b){return"{{"+b+"}}"}).replace(c,"{{splat}}"),callback:b}}var e="([^/]+)",j=/:([\w\d]+)/g,c=/(\*)/,
p="(.+)",n,m,k;b.pathbinder={changeFuns:[],paths:[],begin:function(e){b(function(){var b=l();b?a(b):(g(e),a(e))})},go:function(b){g(b);a(b)},currentPath:function(){return l()},onChange:function(a){b.pathbinder.changeFuns.push(a)}};b(function(){"onhashchange"in window||d(10);b(window).bind("hashchange",h)});b.fn.pathbinder=function(a,e,c){c=c||{};var d=b(this);e=e.split(/\n/);b.each(e,function(){if(this){var e=i(this,function(b){d.trigger(a,[b])});c.bindPath&&d.bind(a,function(a,c){c=c||{};var d=b.mustache(e.template,
c);g(d)});b.pathbinder.paths.push(e)}})}})(jQuery);function $$(b){if(!b){if($$(window).localStorage)return $$(window).localStorage;return $$(window).localStorage={get:function(b){try{var a=JSON.parse(this._storage[b])}catch(g){}return a!==null&&typeof a==="object"?a:{}},set:function(b,a){try{return this._storage[b]=JSON.stringify(a)}catch(g){$.log(g)}},_storage:window.localStorage||{}}}var h=$(b).data("$$");h||(h={},$(b).data("$$",h));return h}
(function(b){function h(a,d){if(a&&a.match&&a.match(/^function/)&&(eval("var f = "+a),typeof f=="function"))return function(){try{var c=f.apply(this,arguments)}catch(g){throw b.log({message:"Error in evently function.",error:g,src:a,hint:d}),g;}if(d==="_init")return!1;return c};return a}function d(a,d){var c=[!0,{}],g=d.evently||{};b.forIn(d.vendor||{},function(b,d){d.evently&&d.evently[a]&&c.push(d.evently[a])});g[a]&&c.push(g[a]);return b.extend.apply(null,c)}function a(a){a._common&&(b.forIn(a,
function(d,c){a[d]=b.extend(!0,{},a._common,c)}),delete a._common);return a}function g(a,d,c,i){if(b.isArray(c))for(var n=0;n<c.length;n++)g(a,d,c[n],i);else{var m=h(c,d);typeof m=="function"?a.bind(d,{args:i},m):typeof m=="string"?a.bind(d,{args:i},function(){b(this).trigger(m);return!1}):a.bind(d,{args:i},function(){l(b(this),c,arguments);return!1});c.path&&a.pathbinder(d,c.path)}}function l(a,d,c,g){g=g||{};var h,i=b.evently.fn.before;for(h in i)if(i.hasOwnProperty(h)&&d[h]&&!g[h]){g[h]=!0;i[h].apply(a,
[d,function(){l(a,d,b.argsToArray(arguments).concat(b.argsToArray(c)),g)},c]);return}var k;b.forIn(b.evently.fn.render,function(b,g){d[b]&&(k=g.apply(a,[d,c]))});b.forIn(b.evently.fn.after,function(b,g){d[b]&&g.apply(a,[d,k,c])})}function i(b,g,c){if(c)$$(b).app=c;typeof g=="string"&&(g=d(g,c.ddoc));g=a(g);$$(b).evently=g;if(c&&c.ddoc)$$(b).partials=d("_partials",c.ddoc);return g}b.log=function(a){window&&window.console&&window.console.log&&window.console.log(arguments.length==1?a:arguments)};b.forIn=
function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])};b.argsToArray=function(a){if(!a.callee)return a;for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};b.fn.replace=function(a){b(this).empty().append(a)};b.fn.evently=function(a,d,c){var h=b(this);a=i(h,a,d);b.forIn(a,function(a,b){g(h,a,b,c)});b.forIn(b.evently.fn.setup,function(b,d){a[b]&&d.apply(h,[a[b],c])});return this};b.evently={connect:function(a,d,c){c.forEach(function(c){b(a).bind(c,function(){var a=b.makeArray(arguments),e=a.shift();
a.push(e);b(d).trigger(c,a);return!1})})},paths:[],changesDBs:{},changesOpts:{},utils:{rfun:function(a,b,c){var d=h(b,a);return typeof d=="function"?d.apply(a,c):b},evfun:h},fn:{setup:{},before:{},render:{},after:{}}}})(jQuery);(function(b){b.evently.fn.setup._init=function(b,d){this.trigger("_init",d)}})(jQuery);(function(b){b.evently.fn.before.before=function(h,d,a){b.evently.utils.evfun(h.before,this).apply(this,a);d()}})(jQuery);
(function(b){b.evently.fn.before.async=function(h,d,a){b.evently.utils.evfun(h.async,this).apply(this,[d].concat(b.argsToArray(a)))}})(jQuery);(function(b){var h=b.evently.utils.rfun;b.evently.fn.render.mustache=function(d,a){var g=(d.render||"replace").replace(/\s/g,""),l;l=$$(this).partials;l=b(b.mustache(h(this,d.mustache,a),h(this,d.data,a),h(this,b.extend(!0,l,d.partials),a)));this[g](l);return l}})(jQuery);
(function(b){b.evently.fn.after.selectors=function(h,d,a){var g=(h.render||"replace").replace(/\s/g,""),l=$$(this).app,i=g=="replace"?this:d;h=b.evently.utils.rfun(this,h.selectors,a);b.forIn(h,function(d,g){b(d,i).evently(g,l,a)})}})(jQuery);(function(b){b.evently.fn.after.after=function(h,d,a){b.evently.utils.rfun(this,h.after,a)}})(jQuery);(function(b){function h(a){var g=a.db.name,h=function(a){b("body").trigger("evently-changes-"+g,[a])};if(!b.evently.changesDBs[g]){if(a.db.changes)a.db.changes(null,b.evently.changesOpts).onChange(h);else d(a,h);b.evently.changesDBs[g]=!0}}function d(a,g,h){function i(e){e=a.db.uri+"_changes?heartbeat=10000&feed=longpoll&since="+e;b.evently.changesOpts.include_docs&&(e+="&include_docs=true");b.ajax({url:e,contentType:"application/json",dataType:"json",complete:function(e){e=b.httpData(e,"json");g(e);
d(a,g,e.last_seq)}})}h?i(h):a.db.info({success:function(a){i(a.update_seq)}})}b.evently.fn.setup._changes=function(){var a=this,d=$$(this).app;d&&(b("body").bind("evently-changes-"+d.db.name,function(){a.trigger("_changes")}),h(d),a.trigger("_changes"))};b.evently.followChanges=h})(jQuery);
(function(b){function h(b,a,g,h){var i,e=h.success,j=!1;h.success=function(a){$$(b).inFlight=!1;var g=JSON.stringify($$(b).highKey);a.rows=a.rows.filter(function(a){return JSON.stringify(a.key)!=g});if(a.rows.length>0)h.descending?$$(b).highKey=a.rows[0].key:$$(b).highKey=a.rows[a.rows.length-1].key;e&&e(a,j)};i=h.descending?g+(h.startkey?JSON.stringify(h.startkey):""):g+(h.endkey?JSON.stringify(h.endkey):"");if(i==$$(b).lastViewId){i=$$(b).highKey;if(i!==void 0)h.descending?h.endkey=i:h.startkey=
i;if(!$$(b).inFlight)$$(b).inFlight=!0,a.view(g,h)}else j=!0,$$(b).lastViewId=i,$$(b).highKey=void 0,$$(b).inFlight=!0,a.view(g,h)}b.evently.fn.before.query=function(d,a,g){var l=$$(this).app;d=b.evently.utils.rfun(this,d.query,g);g=d.type;var i=d.view,e=d.success,j={};b.forIn(d,function(a,b){["type","view"].indexOf(a)==-1&&(j[a]=b)});g=="newRows"?(j.success=function(b){b.rows.reverse().forEach(a);e&&e(b)},h(this,l,i,j)):(j.success=function(b){a(b);e&&e(b)},l.view(i,j))}})(jQuery);
